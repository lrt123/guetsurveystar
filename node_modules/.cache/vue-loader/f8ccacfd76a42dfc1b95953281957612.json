{"remainingRequest":"F:\\github\\guetsurveystar\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\github\\guetsurveystar\\src\\components\\Analysis\\MainAnalysisList.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\github\\guetsurveystar\\src\\components\\Analysis\\MainAnalysisList.vue","mtime":1593309905220},{"path":"F:\\github\\guetsurveystar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\github\\guetsurveystar\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\github\\guetsurveystar\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\github\\guetsurveystar\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBbmFseXNpc0NhcmQgZnJvbSAiLi9BbmFseXNpc0NhcmQiOwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogIk1haW5BbmFseXNpc0xpc3QiLAogICAgY29tcG9uZW50czoge0FuYWx5c2lzQ2FyZH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgZmV0Y2hEYXRhKCkgewogICAgICAgICAgdGhpcy4kaHR0cC5nZXQoIi9xdWVzdGlvbm5haXJlLyIrdGhpcy4kcm91dGUucGFyYW1zLnFpZCsiL2FuYWx5emUiLCB7CiAgICAgICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgICAgIHRoaXMucXVlc3Rpb25uYWlyZS50aXRsZSA9IGRhdGEudGl0bGUKICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9ubmFpcmUuc3RhcnRUaW1lID0gZGF0YS5zdGFydF90aW1lCiAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbm5haXJlLmVuZFRpbWUgPSBkYXRhLmVuZF90aW1lCiAgICAgICAgICAgIGNvbnN0IHRlbXAgPSBkYXRhLnF1ZXN0aW9uczsKCiAgICAgICAgICAgIGxldCBkYXRhTGlzdCA9IFtdOwogICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGVtcCl7CiAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQuaXRlbXMpewogICAgICAgICAgICAgICAgZGF0YUxpc3QucHVzaCh7J25hbWUnOiBpLm15b3B0aW9uLCAndmFsdWUnOiBpLmNvdW50fSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZGF0YUxpc3Quc29ydCgoYSwgYikgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIGEudmFsdWUgLSBiLnZhbHVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgZGF0YUxpc3QucHVzaCh7J25hbWUnOicnLCdzdGF0aWMnOiAn5oC76K6hJywgJ3N0YXRpY192YWx1ZSc6IHQudG90YWx9KQogICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbm5haXJlLmZpbGxDb3VudCA9IHQudG90YWwKICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb25MaXN0LnB1c2goCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbklkOnQuaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uVGl0bGU6dC5kZXNjLAogICAgICAgICAgICAgICAgICAgICAgICBxdWVzdGlvblR5cGU6dC50eXBlLAogICAgICAgICAgICAgICAgICAgICAgICBxdWVzdGlvblZhbHVlTGlzdDpkYXRhTGlzdAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICBkYXRhTGlzdCA9IFtdCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5xdWVzdGlvbkxpc3QpCgogICAgICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHttZXNzYWdlOiAiZXJyb3LvvIHml6DmlbDmja7vvIEiLCBkdXJhdGlvbjogMTAwMH0pCiAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgZGV0YWlsKCl7CiAgICAgICAgICAgICAgICB0aGlzLiRodHRwLmdldCgiL3F1ZXN0aW9ubmFpcmUvIit0aGlzLiRyb3V0ZS5wYXJhbXMucWlkKyIvYW5hbHl6ZS9sZXNzb24iLHsKICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09PSAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YS5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsSW5mbyA9IGRhdGEuZGF0YQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFZpc2libGUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoe21lc3NhZ2U6ICJlcnJvciEg6K+75Y+W5aSx6LSl77yBIiwgZHVyYXRpb246IDEwMDB9KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLmNhdGNoKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7bWVzc2FnZTogImVycm9yISDmnI3liqHnq6/ml6Dlk43lupTvvIEiLCBkdXJhdGlvbjogMTAwMH0pCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgfSwKICAgICAgICB0YWJDbGljayh0YWIsZXZlbnQpewogICAgICAgICAgICBpZiAodGFiLm5hbWUgPT09ICdkZXRhaWwnKXsKICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsKCkKICAgICAgICAgICAgfWVsc2UgaWYgKHRhYi5uYW1lID09PSAnb3B0aW9uJyl7CiAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFZpc2libGUgPSBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAgZXhwb3J0VG9FeGNlbCgpIHsKICAgICAgICAgIC8vZXhjZWzmlbDmja7lr7zlh7oKICAgICAgICAgcmVxdWlyZS5lbnN1cmUoW10sICgpID0+IHsKICAgICAgICAgICAgICAgY29uc3QgewogICAgICAgICAgICAgICAgIGV4cG9ydF9qc29uX3RvX2V4Y2VsCiAgICAgICAgICAgICAgICAgICB9ID0gcmVxdWlyZSgnLi4vLi4vYXNzZXRzL2pzL0V4cG9ydDJFeGNlbCcpOwogICAgICAgICAgICAgICBjb25zdCB0SGVhZGVyID0gWyflrablj7cnLCflp5PlkI0nLCAn5LiT5LiaJywgJ+W+l+WIhiddOwogICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJWYWwgPSBbJ2FjY291bnQnLCduYW1lJywgJ21ham9yJywgJ3Njb3JlJ107CiAgICAgICAgICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmRldGFpbEluZm87CiAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmZvcm1hdEpzb24oZmlsdGVyVmFsLCBsaXN0KTsKICAgICAgICAgICAgICAgZXhwb3J0X2pzb25fdG9fZXhjZWwodEhlYWRlciwgZGF0YSwgdGhpcy5xdWVzdGlvbm5haXJlLnRpdGxlKyct57uf6K6h5oOF5Ya1Jyk7CiAgICAgICAgICAgICB9KQogICAgICAgICB9LAogICAgICAgICBmb3JtYXRKc29uKGZpbHRlclZhbCwganNvbkRhdGEpIHsKICAgICAgICAgICAgcmV0dXJuIGpzb25EYXRhLm1hcCh2ID0+IGZpbHRlclZhbC5tYXAoaiA9PiB2W2pdKSkKICAgICAgICAgICAgICAgfQoKfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5mZXRjaERhdGEoKTsKICAgICAgICBjb25zb2xlLmxvZygxMjMsdGhpcy4kcm91dGUucGFyYW1zKQogICAgICAgICAgICBsZXQgdHlwZSA9IHRoaXMuJHJvdXRlLnBhcmFtcy50eXBlCiAgICAgICAgICAgIGlmICh0eXBlICE9PSAxKXsKICAgICAgICAgICAgICAgIHRoaXMudGFiVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy4kcm91dGUucGFyYW1zLnR5cGUpCiAgICB9LAogICAgZGF0YTogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHF1ZXN0aW9ubmFpcmU6IHsKICAgICAgICAgICAgICAgIHRpdGxlOiAn6L+Z5piv5LiA5Liq5qCH6aKYJywKICAgICAgICAgICAgICAgIHN0YXR1czogJ+W3suWujOaIkCcsCiAgICAgICAgICAgICAgICBzdGFydFRpbWU6ICIyMDIwLTYtMTggMTk6MDA6MjUiLAogICAgICAgICAgICAgICAgZW5kVGltZTogIjIwMjAtNy0xIDIwOjAwOjAwIiwKICAgICAgICAgICAgICAgIGZpbGxDb3VudDogMjk5LAogICAgICAgICAgICB9LAogICAgICAgICAgICBxdWVzdGlvbkxpc3Q6IFtdLAogICAgICAgICAgICBzaG93RGV0YWlsOiBmYWxzZSwKICAgICAgICAgICAgZGV0YWlsVmlzaWJsZTogZmFsc2UsCiAgICAgICAgICAgIHRhYlZpc2libGU6IHRydWUsCiAgICAgICAgICAgIHNlbGVjdGVkVGFiOidvcHRpb24nLAogICAgICAgICAgICBkZXRhaWxJbmZvOiBbXQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["MainAnalysisList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MainAnalysisList.vue","sourceRoot":"src/components/Analysis","sourcesContent":["<template>\n    <div>\n        <div class=\"main-analysis-list\">\n            <el-card>\n                <h1>{{questionnaire.title}}</h1>\n                <div class=\"description-box\">\n                    <div>\n                        <b>问卷状态：</b>{{questionnaire.status}}\n                    </div>\n                    <div>\n                        <b>填写人数：</b>{{questionnaire.fillCount}}\n                    </div>\n                    <div>\n                        <b>发布时间：</b>{{questionnaire.startTime}}\n                    </div>\n                    <div>\n                        <b>截止时间：</b>{{questionnaire.endTime}}\n                    </div>\n                    <el-tabs v-if=\"tabVisible\" v-model=\"selectedTab\" @tab-click=\"tabClick\">\n                        <el-tab-pane label=\"查看选项统计\" name=\"option\"></el-tab-pane>\n                        <el-tab-pane label=\"课程目标达成情况\" name=\"detail\"></el-tab-pane>\n                    </el-tabs>\n                </div>\n                <el-button v-if=\"detailVisible\" type=\"primary\" @click=\"exportToExcel\" round id=\"export_btn\">导出</el-button>\n            </el-card>\n            <AnalysisCard\n                    v-if=\"detailVisible===false\"\n                    v-for=\"(item,index) in questionList\"\n                    :key=\"index\"\n                    :question-index=\"index+1\"\n                    :question-id=\"item.questionId\"\n                    :question-title=\"item.questionTitle\"\n                    :question-type=\"item.questionType\"\n                    :question-value-list=\"item.questionValueList\"\n            >\n            </AnalysisCard>\n            <div v-if=\"detailVisible\">\n\n                <el-table\n                        :data=\"detailInfo\"\n                        :default-sort=\"{prop:'account',order:'ascending'}\"\n                >\n                    <el-table-column\n                            prop=\"account\"\n                            label=\"学号\">\n                    </el-table-column>\n                    <el-table-column\n                            prop=\"name\"\n                            label=\"姓名\">\n                    </el-table-column>\n                    <el-table-column\n                            prop=\"major\"\n                            label=\"专业\">\n                    </el-table-column>\n                    <el-table-column\n                            prop=\"score\"\n                            label=\"得分\">\n                    </el-table-column>\n                </el-table>\n\n            </div>\n\n        </div>\n    </div>\n\n</template>\n\n<script>\n    import AnalysisCard from \"./AnalysisCard\";\n\n    export default {\n        name: \"MainAnalysisList\",\n        components: {AnalysisCard},\n        methods: {\n            fetchData() {\n              this.$http.get(\"/questionnaire/\"+this.$route.params.qid+\"/analyze\", {\n              }).then((res) => {\n                const data = res.data.data;\n                this.questionnaire.title = data.title\n                  this.questionnaire.startTime = data.start_time\n                  this.questionnaire.endTime = data.end_time\n                const temp = data.questions;\n\n                let dataList = [];\n                for (const t of temp){\n                  for (const i of t.items){\n                    dataList.push({'name': i.myoption, 'value': i.count})\n                  }\n                  dataList.sort((a, b) => {\n                    return a.value - b.value\n                  });\n                  dataList.push({'name':'','static': '总计', 'static_value': t.total})\n                    this.questionnaire.fillCount = t.total\n                    this.questionList.push(\n                        {\n                            questionId:t.index,\n                            questionTitle:t.desc,\n                            questionType:t.type,\n                            questionValueList:dataList\n                        }\n                    )\n                  dataList = []\n                }\n                console.log(this.questionList)\n\n              }).catch(() => {\n                this.$message({message: \"error！无数据！\", duration: 1000})\n              })\n            },\n            detail(){\n                    this.$http.get(\"/questionnaire/\"+this.$route.params.qid+\"/analyze/lesson\",{\n                    }).then((res) => {\n                        if (res.data.code === 0){\n                            let data = res.data.data\n                            this.detailInfo = data.data\n                            this.detailVisible = true\n                        }else{\n                            this.$message({message: \"error! 读取失败！\", duration: 1000})\n                        }\n                    }).catch(res => {\n                        this.$message({message: \"error! 服务端无响应！\", duration: 1000})\n                    });\n\n            },\n            tabClick(tab,event){\n                if (tab.name === 'detail'){\n                    this.detail()\n                }else if (tab.name === 'option'){\n                    this.detailVisible = false\n                }\n            },\n             exportToExcel() {\n              //excel数据导出\n             require.ensure([], () => {\n                   const {\n                     export_json_to_excel\n                       } = require('../../assets/js/Export2Excel');\n                   const tHeader = ['学号','姓名', '专业', '得分'];\n                   const filterVal = ['account','name', 'major', 'score'];\n                   const list = this.detailInfo;\n                   const data = this.formatJson(filterVal, list);\n                   export_json_to_excel(tHeader, data, this.questionnaire.title+'-统计情况');\n                 })\n             },\n             formatJson(filterVal, jsonData) {\n                return jsonData.map(v => filterVal.map(j => v[j]))\n                   }\n\n    },\n        mounted() {\n            this.fetchData();\n            console.log(123,this.$route.params)\n                let type = this.$route.params.type\n                if (type !== 1){\n                    this.tabVisible = false\n                }\n                console.log(this.$route.params.type)\n        },\n        data: function () {\n            return {\n                questionnaire: {\n                    title: '这是一个标题',\n                    status: '已完成',\n                    startTime: \"2020-6-18 19:00:25\",\n                    endTime: \"2020-7-1 20:00:00\",\n                    fillCount: 299,\n                },\n                questionList: [],\n                showDetail: false,\n                detailVisible: false,\n                tabVisible: true,\n                selectedTab:'option',\n                detailInfo: []\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .main-analysis-list {\n        width: 70%;\n        margin: auto;\n    }\n\n    .description-box {\n        text-align: left;\n        padding-left: 10%;\n        line-height: 30px;\n        font-size: 14px;\n    }\n    #export_btn{\n        margin-top: 10px;\n        margin-bottom: 10px;\n        float: right;\n    }\n</style>\n"]}]}